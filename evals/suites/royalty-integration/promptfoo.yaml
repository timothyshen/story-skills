description: 'Royalty Integration Skill Evaluation'

prompts:
  - file://prompt-wrapper.txt

providers:
  - id: anthropic:claude-sonnet-4-5-20250929
    config:
      temperature: 0
      max_tokens: 4096

defaultTest:
  options:
    timeout: 120000
  vars:
    skill_content: file://../../../packages/plugins/story-royalty/skills/royalty-integration/SKILL.md
    royalty_system: file://../../../packages/plugins/story-royalty/skills/royalty-integration/references/royalty-system.md
    payment_claiming: file://../../../packages/plugins/story-royalty/skills/royalty-integration/references/payment-claiming.md
    revenue_distribution: file://../../../packages/plugins/story-royalty/skills/royalty-integration/references/revenue-distribution.md

tests:
  - vars:
      case_content: file://cases/pay-royalties.md
    assert:
      - type: llm-rubric
        value: file://rubrics/payment-correctness.txt
        threshold: 0.85
        provider: anthropic:claude-sonnet-4-5-20250929
      - type: contains
        value: 'payRoyaltyOnBehalf'
      - type: contains
        value: 'WIP_TOKEN_ADDRESS'

  - vars:
      case_content: file://cases/claim-revenue.md
    assert:
      - type: llm-rubric
        value: file://rubrics/claiming-completeness.txt
        threshold: 0.85
        provider: anthropic:claude-sonnet-4-5-20250929
      - type: contains
        value: 'claimAllRevenue'
      - type: contains
        value: 'ancestorIpId'

  - vars:
      case_content: file://cases/lap-vs-lrp.md
    assert:
      - type: llm-rubric
        value: file://rubrics/payment-correctness.txt
        threshold: 0.85
        provider: anthropic:claude-sonnet-4-5-20250929
      - type: contains
        value: 'LAP'
      - type: contains
        value: 'LRP'

  - vars:
      case_content: file://cases/royalty-vault.md
    assert:
      - type: llm-rubric
        value: file://rubrics/vault-understanding.txt
        threshold: 0.85
        provider: anthropic:claude-sonnet-4-5-20250929
      - type: contains-any
        value: ['IpRoyaltyVault', 'IP Royalty Vault', 'Royalty Vault']
      - type: contains
        value: 'getRoyaltyVaultAddress'
